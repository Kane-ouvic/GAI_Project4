# GAI_Project4

## Overview

This project aims to generate images using Deep Image Prior (DIP) and Denoising Diffusion Probabilistic Model (DDPM). The DIP model is used to initialize the prior for the DDPM model, which generates high-quality images from noise.

## Environment Setup

### Prerequisites

- Python 3.x
- PyTorch
- Matplotlib
- scikit-image
- torchvision

### Installation Steps

1. Clone this repository:
   ```bash
   git clone https://github.com/yourusername/GAI_Project4.git
   cd GAI_Project4
   ```

2. Create and activate a virtual environment:

   ```bash
    python -m venv env
    source env/bin/activate  # On Windows, use `env\Scripts\activate`
   ```


3. Install dependencies:
   ```bash
    pip install -r requirements.txt
   ```

## Directory Structure
```
GAI_Project4/
├── README.md
├── requirements.txt
├── train_dip.py
├── train_ddpm.py
├── evaluate.py
├── models/
│   ├── __init__.py
│   ├── dip.py
│   └── ddpm.py
├── utils/
│   ├── __init__.py
│   └── data_loader.py
└── images/
    └── 8000.jpg  # Sample input image

```

## Running Steps

### Train the DIP Model
1. Run train_dip.py to train the DIP model and save its output:
    ```bash
    python train_dip.py --image_path ./images/8000.jpg
    ```
This script will train the DIP model and save the generated images every 1000 epochs in the output_images folder. The final output will be saved in the dip_output.pt file.

### Train the DDPM Model
2. Run train_ddpm.py to use the output of the DIP model as the initial prior and train the DDPM model:
    ```bash
    python train_ddpm.py --image_path ./images/8000.jpg
    ```
This script will train the DDPM model and save the generated images every 1000 epochs in the ddpm_output_images folder. The final output will be saved in the ddpm_loss_curve.png file.

### Evaluate the Model
3. Run evaluate.py to use the DIP model to initialize the DDPM model and generate images for evaluation:
    ```bash
    python evaluate.py --image_path ./images/8000.jpg
    ```
This script will generate images and display the final generated image.

## Model Description
### Deep Image Prior (DIP)
DIP is an image restoration method that uses a convolutional neural network to generate high-quality images without needing training data. In this project, DIP is used to generate an initial image as a prior for the DDPM.

### Denoising Diffusion Probabilistic Models (DDPM)
DDPM is a generative model that generates high-quality images through a step-by-step denoising process. In this project, DDPM uses the image generated by the DIP model as an initial prior to generate the final image from noise.

### Results and Visualization
The loss curves and generated images during the training process will be saved in the project directory. You can evaluate the model's performance by reviewing these files.